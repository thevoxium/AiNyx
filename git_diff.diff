<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>
<style type="text/css">
.ansi2html-content { display: inline; white-space: pre-wrap; word-wrap: break-word; }
.body_foreground { color: #AAAAAA; }
.body_background { background-color: #000000; }
.inv_foreground { color: #000000; }
.inv_background { background-color: #AAAAAA; }
.ansi1 { font-weight: bold; }
.ansi32 { color: #00aa00; }
.ansi36 { color: #00aaaa; }
.ansi41 { background-color: #aa0000; }
</style>
</head>
<body class="body_foreground body_background" style="font-size: normal;" >
<pre class="ansi2html-content">
<span class="ansi1">diff --git a/app.py b/app.py</span>
<span class="ansi1">index dc19cec..8574973 100644</span>
<span class="ansi1">--- a/app.py</span>
<span class="ansi1">+++ b/app.py</span>
<span class="ansi36">@@ -227,5 +227,36 @@</span> def handle_command(command):
     
     emit('output', output)
 
<span class="ansi32">+</span>
<span class="ansi32">+</span>
<span class="ansi32">+</span>
<span class="ansi32">+</span><span class="ansi32"># Add this new route</span>
<span class="ansi32">+</span><span class="ansi32">@app.route('/git_diff', methods=['POST'])</span>
<span class="ansi32">+</span><span class="ansi32">def git_diff():</span>
<span class="ansi32">+</span><span class="ansi32">    try:</span>
<span class="ansi32">+</span><span class="ansi32">        directory = session.get('current_directory', '')</span>
<span class="ansi32">+</span><span class="ansi32">        if not directory:</span>
<span class="ansi32">+</span><span class="ansi32">            return jsonify({"status": "error", "message": "No directory selected"})</span>
<span class="ansi32">+</span><span class="ansi41">        </span>
<span class="ansi32">+</span><span class="ansi32">        # Run git diff command</span>
<span class="ansi32">+</span><span class="ansi32">        result = subprocess.run(['git', 'diff', '--color'],</span><span class="ansi41"> </span>
<span class="ansi32">+</span><span class="ansi32">                                cwd=directory,</span><span class="ansi41"> </span>
<span class="ansi32">+</span><span class="ansi32">                                capture_output=True,</span><span class="ansi41"> </span>
<span class="ansi32">+</span><span class="ansi32">                                text=True,</span><span class="ansi41"> </span>
<span class="ansi32">+</span><span class="ansi32">                                check=True)</span>
<span class="ansi32">+</span><span class="ansi41">        </span>
<span class="ansi32">+</span><span class="ansi32">        # Convert ANSI color codes to HTML</span>
<span class="ansi32">+</span><span class="ansi32">        from ansi2html import Ansi2HTMLConverter</span>
<span class="ansi32">+</span><span class="ansi32">        conv = Ansi2HTMLConverter()</span>
<span class="ansi32">+</span><span class="ansi32">        html_diff = conv.convert(result.stdout)</span>
<span class="ansi32">+</span><span class="ansi41">        </span>
<span class="ansi32">+</span><span class="ansi32">        return jsonify({"status": "success", "diff": html_diff})</span>
<span class="ansi32">+</span><span class="ansi32">    except subprocess.CalledProcessError as e:</span>
<span class="ansi32">+</span><span class="ansi32">        return jsonify({"status": "error", "message": f"Git diff failed: {e.stderr}"})</span>
<span class="ansi32">+</span><span class="ansi32">    except Exception as e:</span>
<span class="ansi32">+</span><span class="ansi32">        return jsonify({"status": "error", "message": str(e)})</span>
<span class="ansi32">+</span>
<span class="ansi32">+</span>
<span class="ansi32">+</span>
 if __name__ == '__main__':
     socketio.run(app, debug=True)
\ No newline at end of file
<span class="ansi1">diff --git a/static/script.js b/static/script.js</span>
<span class="ansi1">index d4b399e..f50661d 100644</span>
<span class="ansi1">--- a/static/script.js</span>
<span class="ansi1">+++ b/static/script.js</span>
<span class="ansi36">@@ -566,6 +566,35 @@</span> function loadFile(filename) {
 
 
 
<span class="ansi32">+</span><span class="ansi32">function getGitDiff() {</span>
<span class="ansi32">+</span><span class="ansi32">    fetch('/git_diff', {</span>
<span class="ansi32">+</span><span class="ansi32">        method: 'POST',</span>
<span class="ansi32">+</span><span class="ansi32">        headers: { 'Content-Type': 'application/json' },</span>
<span class="ansi32">+</span><span class="ansi32">    })</span>
<span class="ansi32">+</span><span class="ansi32">    .then(response =&gt; response.json())</span>
<span class="ansi32">+</span><span class="ansi32">    .then(data =&gt; {</span>
<span class="ansi32">+</span><span class="ansi32">        if (data.status === 'success') {</span>
<span class="ansi32">+</span><span class="ansi32">            // Create a new tab to display the diff</span>
<span class="ansi32">+</span><span class="ansi32">            const diffFilename = 'git_diff.diff';</span>
<span class="ansi32">+</span><span class="ansi32">            openFiles[diffFilename] = data.diff;</span>
<span class="ansi32">+</span><span class="ansi32">            openFileTab(diffFilename, data.diff);</span>
<span class="ansi32">+</span><span class="ansi41">            </span>
<span class="ansi32">+</span><span class="ansi32">            // Set the content type to HTML</span>
<span class="ansi32">+</span><span class="ansi32">            editor.getModel().setMode('text/html');</span>
<span class="ansi32">+</span><span class="ansi41">            </span>
<span class="ansi32">+</span><span class="ansi32">            // Apply the HTML content to the editor</span>
<span class="ansi32">+</span><span class="ansi32">            editor.setValue(data.diff);</span>
<span class="ansi32">+</span><span class="ansi32">        } else {</span>
<span class="ansi32">+</span><span class="ansi32">            showNotification('Error getting git diff: ' + data.message, 'error');</span>
<span class="ansi32">+</span><span class="ansi32">        }</span>
<span class="ansi32">+</span><span class="ansi32">    })</span>
<span class="ansi32">+</span><span class="ansi32">    .catch(error =&gt; {</span>
<span class="ansi32">+</span><span class="ansi32">        showNotification('Error: ' + error.message, 'error');</span>
<span class="ansi32">+</span><span class="ansi32">    });</span>
<span class="ansi32">+</span><span class="ansi32">}</span>
<span class="ansi32">+</span>
<span class="ansi32">+</span>
<span class="ansi32">+</span>
 
 document.getElementById('chat-input-area').addEventListener('keypress', function(e) {
     if (e.key === 'Enter' &amp;&amp; !e.shiftKey) {
<span class="ansi1">diff --git a/static/styles.css b/static/styles.css</span>
<span class="ansi1">index 8169887..14428b5 100644</span>
<span class="ansi1">--- a/static/styles.css</span>
<span class="ansi1">+++ b/static/styles.css</span>
<span class="ansi36">@@ -604,4 +604,13 @@</span> body {
 
 #directory-list, #file-list {
     margin-top: 10px;
<span class="ansi32">+</span><span class="ansi32">}</span>
<span class="ansi32">+</span>
<span class="ansi32">+</span>
<span class="ansi32">+</span><span class="ansi32">.btn-git-diff {</span>
<span class="ansi32">+</span><span class="ansi32">    background: linear-gradient(to right, #6e5494, #4078c0);</span>
<span class="ansi32">+</span><span class="ansi32">}</span>
<span class="ansi32">+</span>
<span class="ansi32">+</span><span class="ansi32">.btn-git-diff:hover {</span>
<span class="ansi32">+</span><span class="ansi32">    background: linear-gradient(to right, #5a4578, #3672b7);</span>
 }
\ No newline at end of file
<span class="ansi1">diff --git a/templates/index.html b/templates/index.html</span>
<span class="ansi1">index d9d0b04..530336c 100644</span>
<span class="ansi1">--- a/templates/index.html</span>
<span class="ansi1">+++ b/templates/index.html</span>
<span class="ansi36">@@ -30,6 +30,10 @@</span>
                     &lt;button class="btn btn-browse" onclick="browseDirectory()"&gt;
                         &lt;span class="icon"&gt;üìÅ&lt;/span&gt;Browse Directory
                     &lt;/button&gt;
<span class="ansi32">+</span><span class="ansi32">                    &lt;button onclick="getGitDiff()" class="btn btn-git-diff"&gt;</span>
<span class="ansi32">+</span><span class="ansi32">                        &lt;svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"&gt;&lt;path d="M16 3v5h5"/&gt;&lt;path d="M16 3l5 5"/&gt;&lt;path d="M21 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h6"/&gt;&lt;/svg&gt;</span>
<span class="ansi32">+</span><span class="ansi32">                        &lt;span&gt;Git Diff&lt;/span&gt;</span>
<span class="ansi32">+</span><span class="ansi32">                    &lt;/button&gt;</span>
                 &lt;/div&gt;
                 &lt;div id="current-path"&gt;&lt;/div&gt;
                 &lt;div id="directory-list"&gt;&lt;/div&gt;

</pre>
</body>

</html>
